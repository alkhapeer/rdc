<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title data-i18n="app.title">نظام البطاقات</title>
  <meta name="theme-color" content="#0ea5e9" />
  <link rel="manifest" href="manifest.json" />
  <link rel="apple-touch-icon" href="icon-192.png" />
  <link rel="icon" href="icon-192.png" />
  <link rel="stylesheet" href="styles.css" />
  <meta name="description" content="Card System — 100% local (Excel + LocalStorage)" />
</head>
<body>
  <header class="topbar">
    <div class="wrap">
      <h1 data-i18n="app.name">نظام البطاقات</h1>
      <nav class="nav">
        <a href="#verify" class="tab-link" data-target="tab-verify" data-i18n="nav.verify">التحقق</a>
        <a href="#my" class="tab-link" data-target="tab-my" data-i18n="nav.my">بطاقاتي</a>
        <a href="#issue" class="tab-link" data-target="tab-issue" data-i18n="nav.issue">إصدار بطاقة رقمية</a>
        <a href="#renew" class="tab-link" data-target="tab-renew" data-i18n="nav.renew">تجديد</a>
        <a href="#market" class="tab-link" data-target="tab-market" data-i18n="nav.market">السوق</a>
        <a href="#guide" class="tab-link" data-target="tab-guide" data-i18n="nav.guide">الإرشادات</a>
        <a href="admin.html" data-i18n="nav.admin">أدمن</a>
      </nav>
      <div class="lang-switch">
        <button id="btn-install" class="secondary hide" data-i18n="common.install">تنصيب التطبيق</button>
        <button id="lang-ar">العربية</button>
        <button id="lang-en">English</button>
      </div>
    </div>
  </header>

  <main class="wrap space">
    <section id="tab-verify" class="tab-section active">
      <div class="card">
        <h2 data-i18n="verify.title">التحقق من البطاقة</h2>
        <div class="row">
          <input id="v-code" placeholder="Card ID" />
          <button id="btn-verify" class="primary" data-i18n="verify.btn">تحقق</button>
        </div>
        <div id="verify-res" class="space-sm"></div>
      </div>
    </section>

    <section id="tab-my" class="tab-section">
      <div class="card">
        <h2 data-i18n="my.title">بطاقاتي</h2>
        <div id="my-cards" class="grid-3"></div>
      </div>
    </section>

    <section id="tab-issue" class="tab-section">
      <div class="card">
        <h2 data-i18n="issue.title">إظهار الكارت الرقمي</h2>
        <div class="row">
          <input id="i-code" placeholder="Card ID" />
          <button id="btn-show-card" class="primary" data-i18n="issue.show">عرض</button>
        </div>
        <div id="digital-card" class="digital-card hide"></div>
      </div>
    </section>

    <section id="tab-renew" class="tab-section">
      <div class="card">
        <h2 data-i18n="renew.title">تجديد البطاقة</h2>
        <p class="muted" data-i18n="renew.desc">أدخل Card ID وابدأ طلب التجديد. سيتم إرسال طلب إلى الإدارة.</p>
        <div class="row">
          <input id="r-code" placeholder="Card ID" />
          <button id="btn-renew" class="primary" data-i18n="renew.start">طلب تجديد</button>
        </div>
        <div id="renew-msg" class="space-sm"></div>
      </div>
    </section>

    <section id="tab-market" class="tab-section">
      <div class="card">
        <h2 data-i18n="market.title">السوق</h2>
        <div class="row">
          <input id="m-country" placeholder="Country" />
          <input id="m-min" type="number" step="0.01" placeholder="Min $" />
          <input id="m-max" type="number" step="0.01" placeholder="Max $" />
          <button id="btn-filter" class="secondary" data-i18n="market.filter">تصفية</button>
        </div>
        <div id="market-list" class="grid-3 space-sm"></div>
      </div>

      <div class="card">
        <h3 data-i18n="market.sellTitle">إدراج بطاقة للبيع</h3>
        <p class="muted" data-i18n="market.sellNote">سيتم انتظار موافقة الإدارة قبل ظهورها.</p>
        <div class="row">
          <input id="s-code" placeholder="Card ID" />
          <input id="s-country" placeholder="Country" />
          <input id="s-price" type="number" step="0.01" placeholder="Price $" />
          <input id="s-contact" placeholder="Contact (WhatsApp/Email)" />
          <button id="btn-sell" class="primary" data-i18n="market.sellBtn">إرسال</button>
        </div>
      </div>
    </section>

    <section id="tab-guide" class="tab-section">
      <div class="card">
        <h2 data-i18n="guide.title">كيف تستفيد من البطاقة؟</h2>
        <div class="row">
          <div style="flex:1;min-width:260px">
            <p>الشراء: 30$ → تحصل على 3 بطاقات إضافية (Pending) بسعر 10$ للواحدة. عند بيع أي بطاقة إضافية: تدفع 10$ لتفعيلها بالاسم الجديد. بعد بيع 3 بطاقات إضافية: تحصل تلقائيًا على 3 بطاقات Pending جديدة.</p>
            <ul>
              <li>Cards: Active / Pending / Expired</li>
              <li>ربح الإدارة: 10$ لكل بطاقة</li>
              <li>ربح العميل: 20$ لكل بطاقة</li>
            </ul>
            <p><a href="guide.pdf" target="_blank">تحميل PDF</a></p>
            <p><video controls width="360" src="training.mp4" style="max-width:100%"></video></p>
          </div>
          <div style="flex:1;min-width:260px">
            <svg viewBox="0 0 420 260" width="100%" height="100%">
              <defs><linearGradient id="g" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="#0ea5e9"/><stop offset="100%" stop-color="#0b1220"/></linearGradient></defs>
              <rect x="0" y="0" width="420" height="260" fill="url(#g)" rx="14"/>
              <g fill="#fff" font-family="Arial" font-size="12">
                <rect x="20" y="20" width="120" height="50" rx="10" fill="#ffffff22" stroke="#fff"/><text x="80" y="50" text-anchor="middle">Purchase $30</text>
                <rect x="160" y="20" width="120" height="50" rx="10" fill="#ffffff22" stroke="#fff"/><text x="220" y="50" text-anchor="middle">+3 Pending</text>
                <rect x="300" y="20" width="100" height="50" rx="10" fill="#10b981" stroke="#fff"/><text x="350" y="50" text-anchor="middle">Sell</text>
                <path d="M140,45 L160,45" stroke="#fff"/><path d="M280,45 L300,45" stroke="#fff"/>
                <rect x="160" y="100" width="120" height="50" rx="10" fill="#fbbf24" stroke="#fff"/><text x="220" y="130" text-anchor="middle">Pay $10 → Activate</text>
                <rect x="20" y="180" width="120" height="50" rx="10" fill="#ffffff22" stroke="#fff"/><text x="80" y="210" text-anchor="middle">3 Sales</text>
                <rect x="160" y="180" width="120" height="50" rx="10" fill="#ffffff22" stroke="#fff"/><text x="220" y="210" text-anchor="middle">+3 New Pending</text>
                <path d="M110,205 L160,205" stroke="#fff"/>
              </g>
            </svg>
          </div>
        </div>
        <div class="card space-sm">
          <h3>FAQ</h3>
          <details><summary>هل تعمل أوفلاين؟</summary><p>نعم، بعد أول زيارة يتم تخزين الواجهة محليًا.</p></details>
          <details><summary>كيف أرفع بيانات جديدة؟</summary><p>من لوحة الأدمن → استيراد Excel.</p></details>
          <details><summary>كيف أتلقى إشعارات؟</summary><p>يمكن تفعيل إشعارات المتصفح (محلية أثناء فتح الموقع). دعم الـ Push الكامل يتطلب خادم وسيتم دعمه لاحقًا.</p></details>
        </div>
      </div>
    </section>
  </main>

  <footer class="footer"><div class="wrap"><small>© 2025</small></div></footer>

  <!-- Terms Modal -->
<!-- Terms Modal -->
<div id="overlay" class="overlay hidden" aria-hidden="true"></div>
<div id="terms-modal" class="modal hidden" aria-hidden="true">
  <div class="modal-card">
    <h3>الشروط والسياسات</h3>
    <p>… نص مختصر عن السياسات …</p>
    <label class="row" style="margin:.75rem 0">
      <input type="checkbox" id="terms-check">
      <span style="margin-inline-start:.5rem">أوافق على الشروط والسياسات</span>
    </label>
    <button id="btn-accept-terms" class="primary" disabled>أوافق على الشروط والسياسات</button>
   </div>
  </div>


  </div>

  <script src="shared-utils.js"></script>
  <script src="app.js"></script>
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('./service-worker.js').catch(console.error);
      });
    }
  </script>
</body>
</html>
