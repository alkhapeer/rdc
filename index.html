
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="theme-color" content="#0ea5e9"/>
  <title data-i18n="app.title">نظام البطاقات (RDC) — إصدار عام</title>
  <link rel="manifest" href="manifest.json"/>
  <link rel="icon" href="icon-192.png"/>
  <link rel="stylesheet" href="styles.css"/>
  <script>
    if('serviceWorker' in navigator){ addEventListener('load',()=>navigator.serviceWorker.register('./service-worker.js').catch(console.error)); }
  </script>
</head>
<body>
  <header>
    <div class="container hero">
      <div class="brand">
        <span class="badge">PWA</span>
        <h1 data-i18n="app.title">نظام البطاقات (RDC) — إصدار عام</h1>
      </div>
      <div class="row">
        <button id="btn-install" class="btn pill hidden" data-i18n="app.install">تنصيب التطبيق</button>
        <div class="lang-switch">
          <button id="btn-ar" class="btn pill">العربية</button>
          <button id="btn-en" class="btn pill">English</button>
        </div>
      </div>
    </div>
    <div class="container">
      <nav class="tabs" id="tabs">
        <button class="tab-btn" data-target="tab-check" data-i18n="tabs.check">التحقق</button>
        <button class="tab-btn" data-target="tab-my" data-i18n="tabs.my">بطاقاتي</button>
        <button class="tab-btn" data-target="tab-issue" data-i18n="tabs.issue">إصدار بطاقة رقمية</button>
        <button class="tab-btn active" data-target="tab-guide" data-i18n="tabs.guide">الإرشادات</button>
        <button class="tab-btn" data-target="tab-renew" data-i18n="tabs.renew">تجديد</button>
        <button class="tab-btn" data-target="tab-renew" data-i18n="tabs.renew">contact us</button>

      </nav>
    </div>
  </header>

  <main class="container">
    <section id="tab-check">
      <div class="card">
        <label data-i18n="check.label">Card ID</label>
        <div class="row">
          <input id="check-id" data-i18n-ph="check.ph" placeholder="RDCXXXX-ABC123" style="flex:1"/>
          <button id="btn-check" class="btn primary" data-i18n="check.btn">تحقّق</button>
        </div>
        <div id="check-result" style="margin-top:.6rem"></div>
      </div>
    </section>

    <section id="tab-my">
      <div class="card">
        <h3 style="margin:0 0 .5rem" data-i18n="my.title">بطاقاتي</h3>
        <div id="my-cards" class="grid"></div>
        <small class="muted" data-i18n="my.empty">لا توجد بطاقات محفوظة بعد.</small>
      </div>
    </section>

    <section id="tab-issue">
      <div class="card">
        <h3 style="margin:0 0 .5rem" data-i18n="issue.title">إصدار بطاقة رقمية قابلة للتحميل</h3>
        <label data-i18n="issue.idLabel">Card ID (يجب أن يبدأ بـ RDC)</label>
        <input id="issue-id" placeholder="RDCXXXX-ABC123"/>
        <label data-i18n="issue.name">الاسم على البطاقة</label>
        <input id="issue-name" placeholder="الاسم"/>
        <label data-i18n="issue.phone">الهاتف (اختياري)</label>
        <input id="issue-phone" placeholder="+201234567890"/>
        <label data-i18n="issue.photo">صورة شخصية (اختياري)</label>
        <input id="issue-photo" type="file" accept="image/*"/>
        <div class="row" style="margin-top:.6rem">
          <button id="btn-generate-card" class="btn primary" data-i18n="issue.btn">توليد وتنزيل</button>
        </div>
        <div id="card-preview" class="row" style="margin-top:.75rem"></div>
      </div>
    </section>

    <section id="tab-guide" class="active">
      <div class="card">
        <h3 style="margin:0 0 .5rem" data-i18n="guide.title">الإرشادات / البزنس بلان</h3>
        <p data-i18n="guide.desc">هذا الإصدار عام — يعتمد على ملف cards-public.json الذي ترفعه مع الملفات.</p>
      </div>

      <div class="card">
        <h3 style="margin:0 0 .5rem" data-i18n="guide.mediaTitle">محتوى تعليمي</h3>
        <div class="row">
          <button id="btn-open-pdf" class="btn pill hidden" data-i18n="guide.openPdf">فتح الدليل (guide.pdf)</button>
          <small id="guide-missing" class="muted hidden" data-i18n="guide.missing">ارفع الملفات بجوار index.html</small>
        </div>
        <video id="video-player" class="hidden" controls playsinline style="margin-top:.5rem;border-radius:12px;max-width:100%"></video>
      </div>

      <div class="card">
        <h3 style="margin:0 0 .5rem">رسم توضيحي للنمو الذاتي</h3>
        <svg viewBox="0 0 900 380" style="width:100%;height:auto;background:#0b1220;border:1px solid #1f2937;border-radius:12px">
          <defs>
            <linearGradient id="g" x1="0" y1="0" x2="1" y2="1"><stop offset="0" stop-color="#0ea5e9"/><stop offset="1" stop-color="#22d3ee"/></linearGradient>
            <marker id="arrow" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse">
              <path d="M 0 0 L 10 5 L 0 10 z" fill="#94a3b8"></path>
            </marker>
          </defs>
          <rect x="10" y="10" width="880" height="360" rx="16" fill="#0b1220" stroke="#1f2937"></rect>
          <g>
            <rect x="40" y="60" width="160" height="80" rx="12" fill="url(#g)" stroke="#1f2937"></rect>
            <text x="120" y="110" text-anchor="middle" fill="#e5e7eb" font-size="16">30$ شراء بطاقة</text>
            <path d="M200 100 L300 100" stroke="#94a3b8" marker-end="url(#arrow)"/>
            <rect x="300" y="60" width="200" height="80" rx="12" fill="#0f172a" stroke="#1f2937"></rect>
            <text x="400" y="110" text-anchor="middle" fill="#e5e7eb" font-size="16">+3 بطاقات مؤقتة</text>
            <path d="M500 100 L600 100" stroke="#94a3b8" marker-end="url(#arrow)"/>
            <rect x="600" y="60" width="240" height="80" rx="12" fill="#0f172a" stroke="#1f2937"></rect>
            <text x="720" y="110" text-anchor="middle" fill="#e5e7eb" font-size="16">بيع بطاقة = 30$ للمُباع</text>
            <path d="M720 140 L720 240" stroke="#94a3b8" marker-end="url(#arrow)"/>
            <rect x="580" y="240" width="280" height="80" rx="12" fill="#0f172a" stroke="#1f2937"></rect>
            <text x="720" y="290" text-anchor="middle" fill="#e5e7eb" font-size="16">10$ للإدارة → تفعيل</text>
            <path d="M580 280 L160 280" stroke="#94a3b8" marker-end="url(#arrow)"/>
            <rect x="40" y="240" width="320" height="80" rx="12" fill="#0f172a" stroke="#1f2937"></rect>
            <text x="200" y="290" text-anchor="middle" fill="#e5e7eb" font-size="16">من يبيع 3 بطاقات يحصل على 3 أخرى</text>
          </g>
        </svg>
      </div>
    </section>

    <section id="tab-renew">
      <div class="card">
        <h3 style="margin:0 0 .5rem" data-i18n="renew.title">تجديد / التواصل مع الإدارة</h3>
        <label data-i18n="renew.label">Card ID</label>
        <div class="row">
          <input id="renew-id" placeholder="RDCXXXX-ABC123" style="flex:1"/>
          <button id="btn-renew" class="btn primary" data-i18n="renew.btn">فتح واتساب</button>
        </div>
        <small class="muted" data-i18n="renew.note">سيتم تجهيز رسالة جاهزة.</small>
      </div>
    </section>
    <iframe 
      src="https://docs.google.com/forms/d/e/"https://docs.google.com/forms/d/e/1FAIpQLSem_8RjWAryclLqgTaaTLqz1CYg6zCmtfl9N1UyDY1gfOoo5A/viewform?embedded=true"/viewform?embedded=true" 
      width="100%" 
      height="1000" 
      frameborder="0" 
      marginheight="0" 
      marginwidth="0">
      جاري التحميل…
    </iframe>

  </main>
  
  <!-- Terms Modal -->
  <div id="overlay" class="overlay hidden" aria-hidden="true"></div>
  <div id="terms-modal" class="modal hidden" aria-hidden="true">
    <div class="modal-card">
      <h3 style="margin:0 0 .5rem" data-i18n="terms.title">الشروط والسياسات</h3>
      <div style="max-height:42vh;overflow:auto">
        <p data-i18n="terms.brief">مختصر: البطاقات شخصية وتُفعّل بعد الدفع. يمنع العبث.</p>
      </div>
      <label class="row" style="margin:.75rem 0">
        <input type="checkbox" id="terms-check"><span style="margin-inline-start:.5rem" data-i18n="terms.agree">أوافق</span>
      </label>
      <button id="btn-accept-terms" class="btn primary" disabled data-i18n="terms.btn">موافق</button>
    </div>
  </div>
  
  <footer class="container"><small class="muted">© 2025 — Public PWA</small></footer>
  <script type="module" src="app.js"></script>
</body>
</html>
